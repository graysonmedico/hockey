---
title: "hockey analysis"

execute:
    echo: false
---

# Hockey Data

```{r}
#| echo: false
#| message: false
#| warning: false

library(ggimage)
library(ggplot2)
library(dplyr)

# 1. READ the file (Instant!)
sog_leaders_history <- read.csv("sog_leaders_history.csv")

# 2. Add the URL column
plot_data <- sog_leaders_history %>%
  mutate(
    year = as.numeric(substr(seasonId, 1, 4)),
    # Use the NHL image server
    headshot_url = paste0("[https://cms.nhl.bamgrid.com/images/headshots/current/168x168/](https://cms.nhl.bamgrid.com/images/headshots/current/168x168/)", playerId, ".jpg")
  )

# 3. Create the Plot
ggplot(plot_data, aes(x = year, y = shots)) +
  geom_line(color = "lightgrey", size = 0.8) +
  # This draws the faces
  geom_image(aes(image = headshot_url), size = 0.08) + 
  
  # Make the chart look clean
  scale_y_continuous(limits = c(0, NA), expand = expansion(mult = c(0, 0.1))) +
  scale_x_continuous(breaks = seq(1960, 2024, by = 10)) +
  labs(
    title = "NHL Shots on Goal Leaders (Year by Year)",
    subtitle = "Top SOG per season since 1959",
    x = "Season",
    y = "Shots on Goal"
  ) +
  theme_minimal()
```
